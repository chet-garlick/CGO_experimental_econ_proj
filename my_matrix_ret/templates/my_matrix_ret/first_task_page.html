{% extends "global/Page.html" %}
{% load otree static %}

{% block title %}
    Counting Exercises
{% endblock %}

{% block styles %}
	<style>
	#task table, #task th, #task td, #task tr {
		border: 1px solid black; 
		padding: 10px;
		text-align: center;
	}
	#task tr:nth-child(even){background-color: #f2f2f2;}
	
	#earns table, #earns th, #earns td, #earns tr {
		border: 1px solid black;
		padding: 10px;
		text-align: center;
	}
	#earns tr:nth-child(even){background-color: #f2f2f2;}
	</style> 

{% endblock %}
{% block content %}

	<table id="earns">
		<tr>
			<td> Participation Fee </td> <td> {{ participation_fee }} </td>
		</tr>
		<tr>
			<td> Task 1: You solved {{ num_correct_first_task }} tables  </td> <td> {{first_task_payoff}}  </td> 
		</tr>
		<tr>
			<td> If this were Task 2, and you solved {{ num_correct_first_task }} tables,</td> 
		</tr>
		<tr>
			<td> if your card color was RED: </td> <td> {{ if_second_task_red_card }} </td>
		</tr>
		<tr>
			<td> if your card color was GREEN: </td> <td> {{ if_second_task_green_card }} </td>
		</tr>
		
	</table>
	
	
	<p>        
		<h4>Please count the number of ones in the table below. Type your answer into the box, and click the Next button or press the Enter key.</h4> 
    </p>

	<table id="task">
		<tr>
			<td id="int0">{{ int0 }} </td> <td id="int1">{{ int1 }} </td> <td id="int2">{{ int2 }} </td> <td id="int3">{{ int3 }} </td> <td id="int4">{{ int4 }}</td>
		</tr>
		<tr>
			<td id="int5">{{ int5 }} </td> <td id="int6">{{ int6 }} </td> <td id="int7">{{ int7 }} </td> <td id="int8">{{ int8 }} </td> <td id="int9">{{ int9 }} </td>
		</tr>
		<tr>
			<td id="int10">{{ int10 }} </td> <td id="int11">{{ int11 }} </td> <td id="int12">{{ int12 }} </td> <td id="int13">{{ int13 }} </td> <td id="int14">{{ int14 }} </td> 
		</tr>
		<tr> 
			<td id="int15">{{ int15 }} </td> <td id="int16">{{ int16 }} </td> <td id="int17">{{ int17 }} </td> <td id="int18">{{ int18 }} </td> <td id="int19">{{ int19 }} </td>
		</tr> <br>
		<tr> 
			<td id="int20">{{ int20 }} </td> <td id="int21">{{ int21 }} </td> <td id="int22">{{ int22 }} </td> <td id="int23">{{ int23 }} </td> <td id="int24">{{ int24 }} </td>
		</tr> <br>
	</table>
	
	<br>
	
	<form method="post" url='{% url "verify" %}'>{%csrf_token%}
	<input type="text" name="Number of Ones" id="num_of_ones"/>
	<input type="hidden" name="user.input" id ="user.input"/>
	<input type="hidden" name = "s" id="s" value = {{solution}}> 
	<button type="button" id="submitButton"> Submit </button>
	
	</form>

	{% formfield player.user_input label="Number of ones:"%}
    {% next_button %}
	
	<h2> {%autoescape off%} {{correct_last_round}} {%endautoescape %}</h2>

{% endblock %}

{% block scripts %}
	<script>
	
		$ ( " #submitButton " ).click(function() {
			var user_input=$(" #num_of_ones ").val();
			var s= $(" #s ").val()
			var id = '{{ id }}'
			var page_version = '{{ version }}'
			if(!isNaN(user_input) && !($.trim(user_input).length === 0) ){
				$.ajax({
					data: {'user_input': user_input, 's':s, 'id':id,'page_version':page_version},
					url: '{% url "verify" %}',
					dataType:'json',
					success: function(result) {
						for (let i = 0; i < 25; i++) {
							document.getElementById("int" + i).innerHTML = result.ints[i]
						}
						document.getElementById("s").value = result.solution
						document.getElementById("num_of_ones").value = ''
					},
				});	
			}else{
				alert("An error has occurred. Please only input a number.");	
			}
		});

	</script>
{%endblock%}
